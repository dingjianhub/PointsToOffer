# 196 ï¼šåˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±

---

[leetcode-cn é¢˜ç›®åœ°å€](https://leetcode-cn.com/problems/delete-duplicate-emails/)

ðŸ“—difficultyï¼š**Easy**	

ðŸŽ¯Tagsï¼š

+ WHERE è¯­å¥
---

## 1. é¢˜ç›®æè¿°ðŸ“ƒ

ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œæ¥åˆ é™¤ `Person` è¡¨ä¸­æ‰€æœ‰é‡å¤çš„ç”µå­é‚®ç®±ï¼Œé‡å¤çš„é‚®ç®±é‡Œåªä¿ç•™ **Id** **æœ€å°** çš„é‚£ä¸ªã€‚

```mysql
+----+------------------+
| Id | Email            |
+----+------------------+
| 1  | john@example.com |
| 2  | bob@example.com  |
| 3  | john@example.com |
+----+------------------+
Id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚
```

ä¾‹å¦‚ï¼Œåœ¨è¿è¡Œä½ çš„æŸ¥è¯¢è¯­å¥ä¹‹åŽï¼Œä¸Šé¢çš„ `Person` è¡¨åº”è¿”å›žä»¥ä¸‹å‡ è¡Œ:

```mysql
+----+------------------+
| Id | Email            |
+----+------------------+
| 1  | john@example.com |
| 2  | bob@example.com  |
+----+------------------+
```

**æç¤ºï¼š**

+ æ‰§è¡Œ SQL ä¹‹åŽï¼Œè¾“å‡ºæ˜¯æ•´ä¸ª `Person` è¡¨ã€‚
+ ä½¿ç”¨ `delete` è¯­å¥ã€‚



---

## 2. è§£é¢˜æ€è·¯ðŸ’¡

### NOT IN è¯­å¥

#### ä»£ç å®žçŽ°

ä½¿ç”¨ WHERE è¯­å¥çš„è¯ï¼Œå¯ä»¥å†™æˆè¿™æ ·ã€‚

```mysql
SELECT e1.*
FROM emails e1,
     emails e2
WHERE e1.email = e2.email
  AND e1.id > e2.id;
```

![](https://assets.ryantech.ltd/20200904160638.png)

è¿™é‡Œå·²ç»æŸ¥è¯¢å‡ºæ¥ç¬¦åˆè¦æ±‚çš„è¡Œäº†ï¼Œä¿®æ”¹ `SELECT` ä¸º `DELETE` å°±å¯ä»¥åˆ é™¤å¯¹åº”è¡Œäº†ã€‚

```mysql
SELECT e1.*
FROM emails e1 join emails e2
on e1.email = e2.email
  where e1.id > e2.id;
```

```mysql
SELECT id
FROM emails
WHERE id NOT IN (SELECT need.id
                 FROM (SELECT MIN(Id) AS id FROM emails GROUP BY email) AS need);
```

![](https://assets.ryantech.ltd/20200904163239.png)



---

#### 

---

## 3. æ€»ç»“ðŸŽ¯
